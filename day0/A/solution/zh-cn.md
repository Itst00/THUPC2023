{{ self.title() }}

韩豫葳

## 题目简述

$2^k$点的完全图 边权为$a[\text{bitcount}(i\text{ xor } j)]$ 加上$m$条有向带权边 求$s$出发到每个点的最短路

## 算法

对于每个点拆点$f[x][i][j]$表示到前$i$个2进制位已经修改了$j$个后编号为$x$

对于$m$条边直接保留 $x$连向$f[x][0][0]$为0边 $f[x][i][j]$分别向$f[x][i+1][j]$和$f[x\text{ xor } 2^i][i+1][j+1]$为0边 $f[x][k][j]$连向$x$边权为$a[j]$

可以发现0边数量级为$O(nlog^2n)$ 对其用bfs 其余边数量级为$O(nlogn)$跑最短路

即用dijkstra更新的同时跑0边bfs即可